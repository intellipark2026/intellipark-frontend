<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Parking Receipt - INTELLIPARK</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
</head>
<body>
  <div class="navbar" style="display: flex; align-items: center; padding: 10px 20px; background-color: purple;">
    <a href="intelli.html" style="display: flex; align-items: center; text-decoration: none; color: white;">
      <img src="logo.png" alt="IntelliPark Logo" style="height: 40px; margin-right: 10px;">
      <span style="font-size: 20px; font-weight: bold;">INTELLIPARK</span>
    </a>
  </div>


  <div class="container" style="max-width: 600px; margin: 40px auto; padding: 20px; border: 2px solid #ccc; border-radius: 10px; text-align: center;">
    <h2>Parking Receipt</h2>
    <p><strong>Slot:</strong> <span id="slot"></span></p>
    <p><strong>Name:</strong> <span id="name"></span></p>
    <p><strong>Plate Number:</strong> <span id="plate"></span></p>
    <p><strong>Vehicle Type:</strong> <span id="vehicle"></span></p>
    <p><strong>Reserved Time:</strong> <span id="time"></span></p>
    <p><strong>Date Reserved:</strong> <span id="timestamp"></span></p>
    <p><strong>Email:</strong> <span id="email"></span></p>


    <h3 style="margin-top:20px;">QR Code for Entrance</h3>
    <canvas id="qrcode"></canvas>


    <button onclick="window.print()" class="submit-btn" style="margin-top:20px;">üñ® Print Receipt</button>
    <a href="intelli.html" class="back-btn" style="display:block; margin-top:20px;">‚Üê Back to Home</a>
  </div>


  <script>
    const params = new URLSearchParams(window.location.search);
    
    // ‚úÖ Get all parameters with proper fallbacks
    const slot = params.get("slot") || "N/A";
    const name = params.get("name") || "N/A";
    const plate = params.get("plate") || "N/A";
    const vehicle = params.get("vehicle") || "N/A";
    const time = params.get("time") || "N/A";
    const email = params.get("email") || "N/A";
    const timestamp = params.get("timestamp") || new Date().toISOString();

    // Debug: Log to console
    console.log("Receipt Parameters:", { slot, name, plate, vehicle, time, email, timestamp });

    // ‚úÖ Display all values
    document.getElementById("slot").textContent = slot.toUpperCase();
    document.getElementById("name").textContent = name;
    document.getElementById("plate").textContent = plate;
    document.getElementById("vehicle").textContent = vehicle.charAt(0).toUpperCase() + vehicle.slice(1);
    document.getElementById("time").textContent = time;
    document.getElementById("email").textContent = email;
    
    // Format timestamp properly
    try {
      const date = new Date(timestamp);
      if (!isNaN(date.getTime())) {
        document.getElementById("timestamp").textContent = date.toLocaleString();
      } else {
        document.getElementById("timestamp").textContent = new Date().toLocaleString();
      }
    } catch(e) {
      document.getElementById("timestamp").textContent = new Date().toLocaleString();
    }

    // Generate QR code (slot + plate for kiosk scanning)
    const qr = new QRious({
      element: document.getElementById("qrcode"),
      value: `INTELLIPARK|SLOT:${slot}|PLATE:${plate}`,
      size: 200
    });
  </script>
</body>
</html>
